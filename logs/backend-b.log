INFO:     Started server process [54064]
INFO:     Waiting for application startup.
2025-11-02 19:05:15,311 - app.main - INFO - Starting up Portfolio Planner backend
2025-11-02 19:05:15,311 - app.main - INFO - Initializing collaboration client
2025-11-02 19:05:15,334 - app.services.collaboration_client - INFO - Collaboration client initialized for user 00000000-0000-0000-0000-000000000002
2025-11-02 19:05:15,334 - app.services.collaboration_client - INFO - Connecting to collaboration service
2025-11-02 19:05:15,341 - app.services.collaboration_client - INFO - Connected to collaboration service
2025-11-02 19:05:15,341 - app.main - INFO - Collaboration client connected successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
2025-11-02 19:05:15,341 - app.services.collaboration_client - ERROR - Error from collaboration service
2025-11-02 19:05:15,342 - app.services.collaboration_client - WARNING - Disconnected from collaboration service
INFO:     ('127.0.0.1', 62824) - "WebSocket /api/v1/ws/collaborate?user_id=00000000-0000-0000-0000-000000000001" [accepted]
2025-11-02 19:05:32,304 - app.services.websocket_manager - INFO - WebSocket connected: user_id=00000000-0000-0000-0000-000000000001, total_connections=1
INFO:     connection open
INFO:     127.0.0.1:62828 - "GET /api/v1/positions/shared?user_id=00000000-0000-0000-0000-000000000001 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62827 - "GET /api/v1/positions/ideas?user_id=00000000-0000-0000-0000-000000000001 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62827 - "GET /api/v1/positions/shared?user_id=00000000-0000-0000-0000-000000000001 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62828 - "GET /api/v1/positions/ideas?user_id=00000000-0000-0000-0000-000000000001 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62828 - "GET /api/v1/positions/shared?user_id=00000000-0000-0000-0000-000000000001 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62827 - "GET /api/v1/positions/ideas?user_id=00000000-0000-0000-0000-000000000001 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62827 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62828 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62836 - "OPTIONS /api/v1/positions/sync HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:62836 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62854 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62871 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62871 - "OPTIONS /api/v1/positions/sync HTTP/1.1" 200 OK
DEBUG: Found 2 accounts from Schwab API
  - Account: 12345678
  - Account: 87654321
DEBUG: Found 2 enabled accounts in database
DEBUG: Enabled hashes from DB: {'F9C2A8D5E4B6F1A3C7E9D2B4', 'E5B3F89A2C1D4E6F7A8B9C0D'}
DEBUG: Hashes from Schwab API: {'F9C2A8D5E4B6F1A3C7E9D2B4', 'E5B3F89A2C1D4E6F7A8B9C0D'}
DEBUG: Matched accounts: 2
DEBUG: Will fetch positions from 2 accounts
DEBUG: Account E5B3F89A has 10 positions
DEBUG: Sample position keys: ['instrument', 'longQuantity', 'shortQuantity', 'averagePrice', 'marketValue']
DEBUG: Sample instrument keys: ['assetType', 'symbol']
DEBUG: Transformed position - Symbol: AAPL, Type: stock, Value: $15842.98, Legs: 0
DEBUG: Transformed position - Symbol: AAPL  251204C00166351, Type: option, Value: $-250.00, Legs: 0
DEBUG: Account F9C2A8D5 has 9 positions
DEBUG: Sample position keys: ['instrument', 'longQuantity', 'shortQuantity', 'averagePrice', 'marketValue']
DEBUG: Sample instrument keys: ['assetType', 'symbol']
DEBUG: Total positions fetched: 19
INFO:     127.0.0.1:62871 - "POST /api/v1/positions/sync HTTP/1.1" 200 OK
INFO:     127.0.0.1:62871 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62871 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62877 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62879 - "OPTIONS /api/v1/positions/sync HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:62879 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62883 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:62995 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:63001 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:63003 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:63084 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:63454 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:64331 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64575 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65059 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:51525 - "GET /api/v1/positions/actual?status=active&symbol= HTTP/1.1" 200 OK
INFO:     127.0.0.1:51690 - "GET /health HTTP/1.1" 200 OK
